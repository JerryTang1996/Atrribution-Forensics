## 报告初稿（PPt)使用

### 1.简介



### 2.行动简介
+ （1）
+ （2）
+ （3）Patchwork
这次攻击主要针对的是东南亚和中国南海，攻击自2015年12月被检测出到2016年7月报告发布，已感染了约2500台电脑，据报告显示活动最早可追溯到2014年。
Patchwork攻击主要针对军事和政治机构，相对其它APT攻击而言，该APT攻击所使用的全部攻击代码都来自于互联网上的开源代码，成本低，但攻击效果强。
通过Cymmetria MazeRunner以蜜罐的方式捕获了攻击者的活动，推测出其攻击流程如下：
首先，向目标发送以pps为附件的网络钓鱼邮件，当用户点击附件时，pps文件播放，触发漏洞，该漏洞为CVE-2014-4114,存在于未打补丁的Office PowerPoint 2013和2017中。漏洞执行，开始攻击，攻击可分为以下两个阶段：
第一阶段，利用编译的Autolt脚本，进行提权操作，与C&C控制器建立连接，扫描文件并上传。提权操作采用UACME方法，获得更高权限后，运行PowerSploit，通过MeterPreter建立远程连接，收集并上传文件。这一阶段的有效载荷是sysvolinfo.exe。
第二阶段，在确定目标价值后，释放恶意软件7zip.exe，执行磁盘文件的扫描、筛选与上传。同时，为了保证长期的控制，7zip.exe复制自身在C:\Windows\SysWOW64\目录下生成netvmon.exe文件，并以自启动服务Net Monitor 运行。
![image](https://github.com/Bessroy/picture/blob/master/patchwork/2018-10-18_001412.png)

图1 Patchwork攻击流程
图2展示了与C&C连接的分析结果

![image](https://github.com/Bessroy/picture/blob/master/patchwork/2018-10-18_001641.png)

图2 Patchwork溯源结果
+ （4）
+ （5）


### 3.溯源的技术与流程
#### 3.1攻击主机的溯源取证
+ Patchwork：通过MazeRunner，研究人员可以及时知道网络动态，当攻击者发现网络并开始使用时，研究人员收到提醒并捕获到黑客的所有工具，进而可执行反编译等操作。通过MeterPreter的连接，可看出攻击主机的IP地址为45[.]43.192.172，端口号8443。

+ Monsoon（2016）：将截取的样本上传到Virus Total上进行分析，在此次攻击投放的RTF文档中发现修改文档的用户，对该作者进行VT搜索，找到了6个相关文件，并且这六个文件大小相同，利用同一个漏洞，很大可能来自于同一个人。
VT结果显示该文件是从IP地址37.58.60.195主机上WEB服务器提供的，该服务器还提供了其他类似的文件。
37.58.60.195 的地址是比利时的一个合法的邮件服务网站，YMLP公司。其他的恶意文档也指向YMLP。
利用YMLP，攻击者将恶意文档放在邮件中，并进行攻击。

#### 3.2 控制主机溯源取证
+ Patchwork：攻击者通过MeterPreter与攻击主机的通信，将文件内容上传至C&C控制主机，经监测，第一阶段的控制主机IP为212[.]129.13.110，第二阶段尝试对话的主机IP为212[.]83.191.156，遗憾的是，攻击方并没有成功进行第二阶段攻击。

+ Monsoon：Monsoon中的恶意代码在获取C&C地址的时候，相关C&C地址并未预留在恶意代码本身，而是存放在第三方可信网站中。
在第三方可信网站或论坛中预留C&C地址，如在github中
 ![image](https://github.com/JerryTang1996/nothing/blob/master/C%26C%201.png)
某论坛：
![image](https://github.com/JerryTang1996/nothing/blob/master/C%26C%202.png)
“{{“之后的内容就是加密后的C&C地址，但是该内容在原论坛中是看不到的，因为攻击者用白底白字进行评论。
进行解密之后，得到的C&C地址是http://5.254.98.68/mtzpncw/gate.php

#### 3.3 攻击者以及攻击组织溯源取证
Patchwork：通过控制一台C&C控制主机，研究人员获取了大量的恶意代码和PPS文件，发现了攻击时间、域名注册等时间和PPS文件最后编辑时间具有一致性，进而判断出攻击者所处的时区；再根据APT攻击的意图、需求以及钓鱼软件的内容，判断攻击者与印度有关。
#### 3. 4 攻击组织刻画
##### 3. 4. 2 组织来源地域
	Patchwork：印度或亲印地区
##### 3. 4. 3组织主要目标及意图
Patchwork：东南亚及中国南海，窃取军事、政治情报。
##### 3. 4. 4组织攻击方法

攻击方法 | 攻击载体 | 攻击描述
------------ | ------------- | -------------
钓鱼攻击 | 包含恶意代码的邮件附件 | Patchwork利用CVE-2014-4114漏洞，释放inf文件，执行Autolt脚本，首先通过sysvolinfo.exe进行提权并与攻击主机互联，向C&C控制主机上传文件，若有价值则释放7zip.exe，将其重命名隐藏在特定文件夹内，并设置为开机自启动，持续不断向控制主机上传内容。


